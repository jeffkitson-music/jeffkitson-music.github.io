class PYGASC{constructor(){this.fernetIterations=48e4,this.aesIterations=5e3,this.mode=null,this.cleartext=null,this.ciphertext=null,this.password=null,this.salt=null,this.key=null}encrypt(e,t,r,o){return"fernet"==o.toLowerCase()?this.fernetEncrypt(e,t,r):(this.mode="aes",this.encryptAES(e,t,r))}encryptAES(e,t,r){if("object"==typeof e||e instanceof Array)e=JSON.stringify(e);var o=CryptoJS.PBKDF2(t,r,{keySize:256,iterations:this.aesIterations,hasher:CryptoJS.algo.SHA256}),n=CryptoJS.enc.Hex.parse(o.toString().slice(0,32)),s=CryptoJS.enc.Hex.parse(o.toString().slice(32,96));return CryptoJS.AES.encrypt(e,s,{iv:n}).toString()}decrypt(e,t,r,o){return"fernet"==o.toLowerCase()?this.fernetDecrypt(e,t,r):(this.mode="aes",this.decryptAES(e,t,r))}fernetEncrypt(e,t,r){var o=this.getFernetKeyFromPassword(t,r),n=new fernet.Secret(o);return new fernet.Token({secret:n,time:Date.parse(1)}).encode(e)}fernetDecrypt(e,t,r){var o=this.getFernetKeyFromPassword(t,r),n=new fernet.Secret(o);return new fernet.Token({secret:n,token:e,ttl:0}).decode()}decryptAES(e,t,r){var o=CryptoJS.PBKDF2(t,r,{keySize:256,iterations:this.aesIterations,hasher:CryptoJS.algo.SHA256}),n=CryptoJS.enc.Hex.parse(o.toString().slice(0,32)),s=CryptoJS.enc.Hex.parse(o.toString().slice(32,96)),i=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(e)}),a=CryptoJS.AES.decrypt(i,s,{iv:n}).toString(CryptoJS.enc.Utf8);return this.isJson(a)&&(a=JSON.parse(a)),a}getFernetKeyFromPassword(e,t){var r=CryptoJS.PBKDF2(e,t,{keySize:8,iterations:this.fernetIterations,hasher:CryptoJS.algo.SHA256}),o=CryptoJS.enc.Hex.stringify(r);return this.hexToBase64(o)}hexToBase64(e){return btoa(e.match(/\w{2}/g).map((function(e){return String.fromCharCode(parseInt(e,16))})).join(""))}isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}}function example(){var e="Lorem ipsum dolor sit amet, consectetur adipiscing elit.";console.log("Sample Text: "+e);var t="hello",r="world",o=new PYGASC,n=o.getFernetKeyFromPassword(t,r),s=o.encrypt(e,t,r,mode="fernet"),i=o.decrypt(s,t,r,mode="fernet");console.log("=== FERNET ==="),console.log("Fernet Key:"+n),console.log("Fernet Ciphertext: "+s),console.log("Fernet Cleartext: "+i);var a=o.encrypt(e,t,r,mode="aes"),c=o.decrypt(a,t,r,mode="aes");console.log("=== AES ==="),console.log("AES Ciphertext: "+a),console.log("AES Cleartext: "+c)}example();
