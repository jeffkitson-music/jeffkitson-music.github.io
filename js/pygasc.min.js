function encrypt(e,r,t){if("object"==typeof e||"array"==typeof e)var e=JSON.stringify(e);var i=CryptoJS.PBKDF2(r,t,{keySize:256,iterations:1e3,hasher:CryptoJS.algo.SHA256}),n=CryptoJS.enc.Hex.parse(i.toString().slice(0,32)),a=CryptoJS.enc.Hex.parse(i.toString().slice(32,96));return CryptoJS.AES.encrypt(e,a,{iv:n}).toString()}function decrypt(e,r,t){var i=e,n=CryptoJS.PBKDF2(r,t,{keySize:256,iterations:1e3,hasher:CryptoJS.algo.SHA256}),a=CryptoJS.enc.Hex.parse(n.toString().slice(0,32)),c=CryptoJS.enc.Hex.parse(n.toString().slice(32,96));CryptoJS.AES.decrypt(i,c,{iv:a});var o=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(i)}),s=CryptoJS.AES.decrypt(o,c,{iv:a}).toString(CryptoJS.enc.Utf8);return(jsontf=isJson(s))&&(s=JSON.parse(s)),s}function isJson(e){try{JSON.parse(e)}catch(r){return!1}return!0}function example(){var e="Hello World",r="lazydog",t="salt";Logger.log("Original: "+e);var i=encrypt(e,r,t);Logger.log("Ciphertext: "+i);var n=decrypt(i,r,t);Logger.log("Decrypted from ciphertext: "+n)}
